---
output: 
  github_document:
    df_print: tibble
---

```{r setup, message = FALSE}
library(tidyverse)
library(readxl)
```
```{r}
download.file("https://zenodo.org/record/7814638/files/RAMLDB%20v4.61.zip?download=1", "fish.zip")
```
```{r}
unzip("fish.zip")
```

```{r}
mcatch<-read_csv("RAMCore/MCatch.csv")
mcatch
```
```{r}
xlsx<-"Excel/RAMLDB v4.61 (assessment data only).xlsx"
readxl::excel_sheets(xlsx)

ts1<-read_xlsx(xlsx, sheet="timeseries.1")
ts2<-read_xlsx(xlsx, sheet="timeseries.2")

ts<-bind_rows(ts1, ts2) |> 
  distinct()|> 
  filter(tsid=="TCbest-MT")
```
```{r}
metrics<- read_xlsx(xlsx, sheet= "tsmetrics")
units<-metrics |> 
  filter (tscategory=="CATCH or LANDINGS") |>
  filter(tsunitslong=="Metric tons")
```
```{r}
ts<-ts|> left_join(metrics, by=c("tsid"="tsunique"))
ts
```


# Unit 2: Fisheries Collapse Module

This module will focus on understanding and replicating fisheries stock assessment data and fisheries collapse.

Instead of working with independent data.frames, we will be working with a large relational database which contains many different tables of different sizes and shapes, but that all all related to each other through a series of different ids.

## The Database

We will use data from the [RAM Legacy Stock Assessment Database](https://www.ramlegacy.org/database/)

# Exercise 1: Investigating the North-Atlantic Cod

Now we are ready to dive into our data. First, We seek to replicate the following figure from the Millennium Ecosystem Assessment Project using the RAM data.

![](http://espm-157.carlboettiger.info/img/cod.jpg)

## placeholder

```{r}
mtcars %>% 
 ggplot(aes(disp, mpg)) + geom_point()
```

------------------------------------------------------------------------

# Exercise 2: Group Assignment

## Stock Collapses

We seek to replicate the temporal trend in stock declines shown in [Worm et al 2006](http://doi.org/10.1126/science.1132294):

![](http://espm-157.carlboettiger.info/img/worm2006.jpg)
